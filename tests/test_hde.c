/**
 * Copyright (c) 2023 System233
 * 
 * This software is released under the MIT License.
 * https://opensource.org/licenses/MIT
 */

#include "hde64.h"
#include <stdio.h>
int main(int argc, char const *argv[])
{
    hde64s hde;
    char buffer[]="\x48\x8D\x0D\x1D\xEC\x00\x00\x0f\x84\x12\x34\x56\x78\x74\xfe\xC0\xC5\x25\xC0\x25\x25\x30\x6B\x27\x33\xC1\x24\x25\x30\x6B\x27\x33\x90\xFF\xA0\x56\x34\x12\x00\xFF\xE0\xE9\xAF\xFF\x05\x00\xEB\xFE\xFF\x25\x00\x00\x00\x00\x48\xC7\xC0\x78\x56\x34\x12\x48\x8B\x80\x56\x34\x12\x00\xFF\x15\xCE\xFF\xFF\xFF\x48\x89\x1D\xD4\xFF\xFF\xFF\xFF\x15\xCE\xFF\xFF\xFF\x48\x89\x05\xDB\xFF\xFF\xFF\x48\x8D\x80\x78\x56\x34\x12\x48\xC7\x05\xB3\xFF\xFF\xFF\x01\x00\x00\x00";
    int off=0;
    while(off<sizeof(buffer)-1){
        //
        int width=hde64_disasm(buffer+off,&hde);
        printf("[%08x] %02x %02x [%02x,%02x,%02x] %02x %08x,%08x\n",hde.flags,hde.opcode,hde.opcode2,hde.modrm_mod,hde.modrm_reg,hde.modrm_rm,hde.sib, hde.imm.imm32,hde.disp.disp32);
        off+=width;
    }
  

    return 0;
}
